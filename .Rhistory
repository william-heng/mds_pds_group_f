dat_confirmed<-melt(dat_confirmed,id=c("Province.State","Country.Region","Lat","Long"))
dat_confirmed
gsub("x","",dat_confirmed$variable)
gsub("X","",dat_confirmed$variable)
library(lubridate)
as.Date(gsub("X","",dat_confirmed$variable),"%m.%d.%y")
dat_confirmed$Date<-as.Date(gsub("X","",dat_confirmed$variable),"%m.%d.%y")
dat_confirmed
dat_confirmed$location<-if_else(dat_confirmed$Province.State==""
,paste0(Country.Region,"-",Country.Region)
,paste0(Country.Region,"-",Province.State)
)
dat_confirmed<-mutate(dat_confirmed,location=if_else(dat_confirmed$Province.State==""
,paste0(Country.Region,"-",Country.Region)
,paste0(Country.Region,"-",Province.State)
)
)
dat_confirmed
names(dat_confirmed)
names(dat_confirmed)[names(dat_confirmed)=="value"]
names(dat_confirmed)[names(dat_confirmed)=="value"]<-"Confirmed"
dat_death<-melt(dat_death,id=c("Province.State","Country.Region","Lat","Long"))
dat_death$Date<-as.Date(gsub("X","",dat_death$variable),"%m.%d.%y")
dat_death<-mutate(dat_death,Location=if_else(dat_death$Province.State==""
,paste0(Country.Region,"-",Country.Region)
,paste0(Country.Region,"-",Province.State)
)
)
names(dat_death)[names(dat_death)=="value"]<-"death"
dat_death<-select(dat_death,Location,Country.Region,Province.State,Date,death)
dat_death
dat_recovered<-melt(dat_recovered,id=c("Province.State","Country.Region","Lat","Long"))
dat_recovered$Date<-as.Date(gsub("X","",dat_recovered$variable),"%m.%d.%y")
dat_recovered<-mutate(dat_recovered,Location=if_else(dat_recovered$Province.State==""
,paste0(Country.Region,"-",Country.Region)
,paste0(Country.Region,"-",Province.State)
)
)
names(dat_recovered)[names(dat_recovered)=="value"]<-"recovered"
dat_recovered<-select(dat_recovered,Location,Country.Region,Province.State,Date,recovered)
dat_recovered
left_join(dat_confirmed,dat_death
,by=c("Location","Country.Region","Province.State","Date")
)
left_join(dat_confirmed,dat_death
,by=c("Location","Country.Region","Province.State","Date")
)
dat_death
head(dat_death)
View(dat_death)
head(dat_confirmed)
dat_confirmed<-read.csv("https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv"
,header=T,stringsAsFactors = F)
dat_death<-read.csv("https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_global.csv"
,header=T,stringsAsFactors = F)
dat_recovered<-read.csv("https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_recovered_global.csv"
,header=T,stringsAsFactors = F)
dat_confirmed<-melt(dat_confirmed,id=c("Province.State","Country.Region","Lat","Long"))
dat_confirmed$Date<-as.Date(gsub("X","",dat_confirmed$variable),"%m.%d.%y")
dat_confirmed<-mutate(dat_confirmed,Location=if_else(dat_confirmed$Province.State==""
,paste0(Country.Region,"-",Country.Region)
,paste0(Country.Region,"-",Province.State)
)
)
names(dat_confirmed)[names(dat_confirmed)=="value"]<-"Confirmed"
dat_confirmed<-select(dat_confirmed,Location,Country.Region,Province.State,Date,Confirmed)
dat_death<-melt(dat_death,id=c("Province.State","Country.Region","Lat","Long"))
dat_death$Date<-as.Date(gsub("X","",dat_death$variable),"%m.%d.%y")
dat_death<-mutate(dat_death,Location=if_else(dat_death$Province.State==""
,paste0(Country.Region,"-",Country.Region)
,paste0(Country.Region,"-",Province.State)
)
)
names(dat_death)[names(dat_death)=="value"]<-"death"
dat_death<-select(dat_death,Location,Country.Region,Province.State,Date,death)
dat_recovered<-melt(dat_recovered,id=c("Province.State","Country.Region","Lat","Long"))
dat_recovered$Date<-as.Date(gsub("X","",dat_recovered$variable),"%m.%d.%y")
dat_recovered<-mutate(dat_recovered,Location=if_else(dat_recovered$Province.State==""
,paste0(Country.Region,"-",Country.Region)
,paste0(Country.Region,"-",Province.State)
)
)
names(dat_recovered)[names(dat_recovered)=="value"]<-"recovered"
dat_recovered<-select(dat_recovered,Location,Country.Region,Province.State,Date,recovered)
left_join(dat_confirmed,dat_death
,by=c("Location","Country.Region","Province.State","Date")
)
dat_covid<-left_Join(
left_join(dat_confirmed,dat_death
,by=c("Location","Country.Region","Province.State","Date"))
,dat_recovered,by=c("Location","Country.Region","Province.State","Date")
)
dat_covid<-left_join(
left_join(dat_confirmed,dat_death
,by=c("Location","Country.Region","Province.State","Date"))
,dat_recovered,by=c("Location","Country.Region","Province.State","Date")
)
dat_covid
head(dat_covid)
dat_unique_location<-unique(dat_covid$Location)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
head(dat_covid)
dat_unique_location
func_R0_manual<-function(dat,l){
dat_temp<-filter(dat,Location==l)
}
func_R0_manual(dat_covid,"Malaysia_Malaysia")
func_R0_manual<-function(dat,l){
dat_temp<-filter(dat,Location==l)
dat_temp
}
func_R0_manual(dat_covid,"Malaysia_Malaysia")
func_R0_manual(dat_covid,"Malaysia-Malaysia")
func_R0_manual<-function(dat,l){
dat_temp<-filter(dat,Location==l)
dat_temp<-dat_temp[order(dat_temp$Date),]
}
func_R0_manual(dat_covid,"Malaysia-Malaysia")
func_R0_manual<-function(dat,l){
dat_temp<-filter(dat,Location==l)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp
}
func_R0_manual(dat_covid,"Malaysia-Malaysia")
week(dat_covid$Date[1])
week(dat_covid$Date[100])
?week
func_R0_manual<-function(dat,l){
dat_temp<-filter(dat,Location==l)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp<-mutate(dat_temp,week=week(Date)+(year(Date)-2020)*52)
dat_temp
}
func_R0_manual(dat_covid,"Malaysia-Malaysia")
tail(func_R0_manual(dat_covid,"Malaysia-Malaysia"))
func_R0_manual<-function(dat,l){
dat_temp<-filter(dat,Location==l)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp<-mutate(dat_temp,week=week(Date)+(year(Date)-2020)*52)
dat_temp_summ<-summarise(group_by(dat_temp,Location,week)
,confirmed_min=min(confirmed)
,confirmed_max=max(confirmed)
,death_min=min(death)
,death_max=max(death)
,recovered_min=min(recovered)
,recovered_max=max(recovered)
)
dat_temp_summ
}
tail(func_R0_manual(dat_covid,"Malaysia-Malaysia"))
func_R0_manual(dat_covid,"Malaysia-Malaysia")
func_R0_manual<-function(dat,l){
dat_temp<-filter(dat,Location==l,confirmed_min>0)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp<-mutate(dat_temp,week=week(Date)+(year(Date)-2020)*52)
dat_temp_summ<-summarise(group_by(dat_temp,Location,week)
,confirmed_min=min(confirmed)
,confirmed_max=max(confirmed)
,death_min=min(death)
,death_max=max(death)
,recovered_min=min(recovered)
,recovered_max=max(recovered)
)
dat_temp_summ
}
func_R0_manual(dat_covid,"Malaysia-Malaysia")
func_R0_manual<-function(dat,l){
dat_temp<-filter(dat,Location==l,confirmed>0)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp<-mutate(dat_temp,week=week(Date)+(year(Date)-2020)*52)
dat_temp_summ<-summarise(group_by(dat_temp,Location,week)
,confirmed_min=min(confirmed)
,confirmed_max=max(confirmed)
,death_min=min(death)
,death_max=max(death)
,recovered_min=min(recovered)
,recovered_max=max(recovered)
)
dat_temp_summ
}
func_R0_manual(dat_covid,"Malaysia-Malaysia")
func_R0_manual<-function(dat,l,N){
dat_temp<-filter(dat,Location==l,confirmed>0)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp<-mutate(dat_temp,week=week(Date)+(year(Date)-2020)*52
,N=N)
dat_temp_summ<-summarise(group_by(dat_temp,Location,week)
,confirmed_min=min(confirmed)
,confirmed_max=max(confirmed)
,death_min=min(death)
,death_max=max(death)
,recovered_min=min(recovered)
,recovered_max=max(recovered)
,N=mean(N)
)
dat_temp_summ
}
func_R0_manual(dat_covid,"Malaysia-Malaysia",31.95*1000000)
func_R0_manual<-function(dat,l,N){
dat_temp<-filter(dat,Location==l,confirmed>0)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp<-mutate(dat_temp,week=week(Date)+(year(Date)-2020)*52
,N=N,R=death+recovered,I=confirmed-R,S=N-confirmed-death-recovered)
dat_temp_summ<-summarise(group_by(dat_temp,Location,week)
,confirmed_min=min(confirmed)
,confirmed_max=max(confirmed)
,death_min=min(death)
,death_max=max(death)
,recovered_min=min(recovered)
,recovered_max=max(recovered)
,N=mean(N)
)
dat_temp_summ
}
func_R0_manual(dat_covid,"Malaysia-Malaysia",31.95*1000000)
func_R0_manual<-function(dat,l,N){
dat_temp<-filter(dat,Location==l,confirmed>0)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp<-mutate(dat_temp,week=week(Date)+(year(Date)-2020)*52
,N=N,R=death+recovered,I=confirmed-R,S=N-confirmed-death-recovered)
dat_temp_summ<-summarise(group_by(dat_temp,Location,week)
,confirmed_min=min(confirmed)
,confirmed_max=max(confirmed)
,death_min=min(death)
,death_max=max(death)
,recovered_min=min(recovered)
,recovered_max=max(recovered)
,N=mean(N)
,S_min=min(S)
,S_max=max(S)
,I_min=min(I)
,I_max=max(I)
,R_min=min(R)
,R_max=max(R)
)
dat_temp_summ
}
func_R0_manual(dat_covid,"Malaysia-Malaysia",31.95*1000000)
func_R0_manual<-function(dat,l,N){
dat_temp<-filter(dat,Location==l,confirmed>0)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp<-mutate(dat_temp,week=week(Date)+(year(Date)-2020)*52
,N=N,R=death+recovered,I=confirmed-R,S=N-confirmed-death-recovered)
dat_temp_summ<-data.frame(summarise(group_by(dat_temp,Location,week)
,confirmed_min=min(confirmed)
,confirmed_max=max(confirmed)
,death_min=min(death)
,death_max=max(death)
,recovered_min=min(recovered)
,recovered_max=max(recovered)
,N=mean(N)
,S_min=min(S)
,S_max=max(S)
,I_min=min(I)
,I_max=max(I)
,R_min=min(R)
,R_max=max(R)
)
)
dat_temp_summ
}
func_R0_manual(dat_covid,"Malaysia-Malaysia",31.95*1000000)
func_R0_manual<-function(dat,l,N){
dat_temp<-filter(dat,Location==l,confirmed>0)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp<-mutate(dat_temp,week=week(Date)+(year(Date)-2020)*52
,N=N,R=death+recovered,I=confirmed-R,S=N-confirmed-death-recovered)
dat_temp_summ<-data.frame(summarise(group_by(dat_temp,Location,week)
,confirmed_min=min(confirmed)
,confirmed_max=max(confirmed)
,death_min=min(death)
,death_max=max(death)
,recovered_min=min(recovered)
,recovered_max=max(recovered)
,N=mean(N)
,S_min=min(S)
,S_max=max(S)
,I_min=min(I)
,I_max=max(I)
,R_min=min(R)
,R_max=max(R)
)
)
dat_temp_summ<-mutate(dat_temp_summ,dS=s_max-S_min,dI=I_max-I_min,dR=R_max-R_min)
dat_temp_summ
}
func_R0_manual(dat_covid,"Malaysia-Malaysia",31.95*1000000)
func_R0_manual<-function(dat,l,N){
dat_temp<-filter(dat,Location==l,confirmed>0)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp<-mutate(dat_temp,week=week(Date)+(year(Date)-2020)*52
,N=N,R=death+recovered,I=confirmed-R,S=N-confirmed-death-recovered)
dat_temp_summ<-data.frame(summarise(group_by(dat_temp,Location,week)
,confirmed_min=min(confirmed)
,confirmed_max=max(confirmed)
,death_min=min(death)
,death_max=max(death)
,recovered_min=min(recovered)
,recovered_max=max(recovered)
,N=mean(N)
,S_min=min(S)
,S_max=max(S)
,I_min=min(I)
,I_max=max(I)
,R_min=min(R)
,R_max=max(R)
)
)
dat_temp_summ<-mutate(dat_temp_summ,dS=S_max-S_min,dI=I_max-I_min,dR=R_max-R_min)
dat_temp_summ
}
func_R0_manual(dat_covid,"Malaysia-Malaysia",31.95*1000000)
func_R0_manual<-function(dat,l,N){
dat_temp<-filter(dat,Location==l,confirmed>0)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp<-mutate(dat_temp,week=week(Date)+(year(Date)-2020)*52
,N=N,R=death+recovered,I=confirmed-R,S=N-confirmed-death-recovered)
dat_temp_summ<-data.frame(summarise(group_by(dat_temp,Location,week)
,confirmed_min=min(confirmed)
,confirmed_max=max(confirmed)
,death_min=min(death)
,death_max=max(death)
,recovered_min=min(recovered)
,recovered_max=max(recovered)
,N=mean(N)
,S_min=min(S)
,S_max=max(S)
,I_min=min(I)
,I_max=max(I)
,R_min=min(R)
,R_max=max(R)
)
)
dat_temp_summ<-mutate(dat_temp_summ,dS=S_max-S_min,dI=I_max-I_min,dR=R_max-R_min
,beta=dS*N/I_min/S_min)
dat_temp_summ
}
func_R0_manual(dat_covid,"Malaysia-Malaysia",31.95*1000000)
func_R0_manual<-function(dat,l,N){
dat_temp<-filter(dat,Location==l,confirmed>0)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp<-mutate(dat_temp,week=week(Date)+(year(Date)-2020)*52
,N=N,R=death+recovered,I=confirmed-R,S=N-confirmed-death-recovered)
dat_temp_summ<-data.frame(summarise(group_by(dat_temp,Location,week)
,confirmed_min=min(confirmed)
,confirmed_max=max(confirmed)
,death_min=min(death)
,death_max=max(death)
,recovered_min=min(recovered)
,recovered_max=max(recovered)
,N=mean(N)
,S_min=min(S)
,S_max=max(S)
,I_min=min(I)
,I_max=max(I)
,R_min=min(R)
,R_max=max(R)
)
)
dat_temp_summ<-mutate(dat_temp_summ,dS=S_max-S_min,dI=I_max-I_min,dR=R_max-R_min
,beta=dS*N/I_min/S_min,gamma=dR/I_min)
dat_temp_summ
}
func_R0_manual(dat_covid,"Malaysia-Malaysia",31.95*1000000)
func_R0_manual<-function(dat,l,N){
dat_temp<-filter(dat,Location==l,confirmed>0)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp<-mutate(dat_temp,week=week(Date)+(year(Date)-2020)*52
,N=N,R=death+recovered,I=confirmed-R,S=N-confirmed-death-recovered)
dat_temp_summ<-data.frame(summarise(group_by(dat_temp,Location,week)
,confirmed_min=min(confirmed)
,confirmed_max=max(confirmed)
,death_min=min(death)
,death_max=max(death)
,recovered_min=min(recovered)
,recovered_max=max(recovered)
,N=mean(N)
,S_min=min(S)
,S_max=max(S)
,I_min=min(I)
,I_max=max(I)
,R_min=min(R)
,R_max=max(R)
)
)
dat_temp_summ<-mutate(dat_temp_summ,dS=S_max-S_min,dI=I_max-I_min,dR=R_max-R_min
,beta=dS*N/I_min/S_min,gamma=dR/I_min,
R0=if_else(gamma=0,0,beta/gamma))
dat_temp_summ
}
func_R0_manual(dat_covid,"Malaysia-Malaysia",31.95*1000000)
func_R0_manual<-function(dat,l,N){
dat_temp<-filter(dat,Location==l,confirmed>0)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp<-mutate(dat_temp,week=week(Date)+(year(Date)-2020)*52
,N=N,R=death+recovered,I=confirmed-R,S=N-confirmed-death-recovered)
dat_temp_summ<-data.frame(summarise(group_by(dat_temp,Location,week)
,confirmed_min=min(confirmed)
,confirmed_max=max(confirmed)
,death_min=min(death)
,death_max=max(death)
,recovered_min=min(recovered)
,recovered_max=max(recovered)
,N=mean(N)
,S_min=min(S)
,S_max=max(S)
,I_min=min(I)
,I_max=max(I)
,R_min=min(R)
,R_max=max(R)
)
)
dat_temp_summ<-mutate(dat_temp_summ,dS=S_max-S_min,dI=I_max-I_min,dR=R_max-R_min
,beta=dS*N/I_min/S_min,gamma=dR/I_min,
R0=if_else(gamma==0,0,beta/gamma))
dat_temp_summ
}
func_R0_manual(dat_covid,"Malaysia-Malaysia",31.95*1000000)
tail(func_R0_manual(dat_covid,"Malaysia-Malaysia",31.95*1000000))
func_R0_manual<-function(dat,l,N){
dat_temp<-filter(dat,Location==l,confirmed>0)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp<-mutate(dat_temp,week=week(Date)+(year(Date)-2020)*52
,N=N,R=death+recovered,I=confirmed-R,S=N-confirmed-death-recovered)
dat_temp_summ<-data.frame(summarise(group_by(dat_temp,Location,week)
,confirmed_min=min(confirmed)
,confirmed_max=max(confirmed)
,death_min=min(death)
,death_max=max(death)
,recovered_min=min(recovered)
,recovered_max=max(recovered)
,N=mean(N)
,S_min=min(S)
,S_max=max(S)
,I_min=min(I)
,I_max=max(I)
,R_min=min(R)
,R_max=max(R)
)
)
dat_temp_summ<-mutate(dat_temp_summ,dS=S_max-S_min,dI=I_max-I_min,dR=R_max-R_min
,beta=dS*N/I_min/S_min,gamma=dR/I_min,
R0=if_else(gamma==0,0,beta/gamma))
dat<-left_join(dat_temp,dat_temp_summ,by=c("Location","week"))
}
tail(func_R0_manual(dat_covid,"Malaysia-Malaysia",31.95*1000000))
func_R0_manual<-function(dat,l,N){
dat_temp<-filter(dat,Location==l,confirmed>0)
dat_temp<-dat_temp[order(dat_temp$Date),]
dat_temp<-mutate(dat_temp,week=week(Date)+(year(Date)-2020)*52
,N=N,R=death+recovered,I=confirmed-R,S=N-confirmed-death-recovered)
dat_temp_summ<-data.frame(summarise(group_by(dat_temp,Location,week)
,confirmed_min=min(confirmed)
,confirmed_max=max(confirmed)
,death_min=min(death)
,death_max=max(death)
,recovered_min=min(recovered)
,recovered_max=max(recovered)
,N=mean(N)
,S_min=min(S)
,S_max=max(S)
,I_min=min(I)
,I_max=max(I)
,R_min=min(R)
,R_max=max(R)
)
)
dat_temp_summ<-mutate(dat_temp_summ,dS=S_max-S_min,dI=I_max-I_min,dR=R_max-R_min
,beta=dS*N/I_min/S_min,gamma=dR/I_min,
R0=if_else(gamma==0,0,beta/gamma))
dat<-left_join(dat_temp,dat_temp_summ,by=c("Location","week","N"))
}
tail(func_R0_manual(dat_covid,"Malaysia-Malaysia",31.95*1000000))
a<-tail(func_R0_manual(dat_covid,"Malaysia-Malaysia",31.95*1000000))
plot(a$R0)
a<-func_R0_manual(dat_covid,"Malaysia-Malaysia",31.95*1000000)
plot(a$R0)
plot(a$R0,a$confirmed)
2.5/7
plot(a$R0,a$confirmed,type = "l")
plot(a$beta,a$confirmed,type = "l")
a
library(shiny)
library(leaflet)
library(dplyr)
library(ggbeeswarm)
dat_hostel<-read.csv("Hostel_cleaned.csv")
setdw("C:/Users/Gigabyte/Google Drive/04 Master DS/WQD7001 PRINCIPLES OF DATA SCIENCE/Group Assignment/mds_pds_group_f/")
setwd("C:/Users/Gigabyte/Google Drive/04 Master DS/WQD7001 PRINCIPLES OF DATA SCIENCE/Group Assignment/mds_pds_group_f/")
dat_hostel<-read.csv("Hostel_cleaned.csv")
runApp()
rm(dat_hostel)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?runGist
runApp()
runApp()
ddata_frame()
dat_hostel
#setwd("C:/Users/Gigabyte/Google Drive/04 Master DS/WQD7001 PRINCIPLES OF DATA SCIENCE/Group Assignment/mds_pds_group_f/")
dat_hostel<-read.csv("./Hostel_cleaned.csv")
dat_hostel
runApp()
runApp()
runApp()
runApp()
runApp()
